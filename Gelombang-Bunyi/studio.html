<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhiQu Studio</title>
    <link rel="icon" href="./foto/logo.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0d1117;
            --card-bg: #161b22;
            --terminal-bg: #010409;
            --keyword: #ff7b72;
            --function: #d2a8ff;
            --variable: #ffa657;
            --comment: #8b949e;
            --accent: #3fb950;
        }

        body {
            font-family: 'Fira Code', monospace;
            background-color: var(--bg-color);
            color: #c9d1d9;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            display: flex;
            gap: 20px;
            width: 100%;
            max-width: 900px;
            height: 450px;
        }

        .blocks-panel {
            flex: 1;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #30363d;
        }

        .block-logic {
            width: 100%;
            background: #21262d;
            color: var(--function);
            border: 1px solid #30363d;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            text-align: left;
        }

        .terminal-panel {
            flex: 2;
            background: var(--terminal-bg);
            border-radius: 8px;
            border: 1px solid #30363d;
            display: flex;
            flex-direction: column;
        }

        #terminal {
            flex: 1;
            padding: 20px;
            font-size: 14px;
            line-height: 1.6;
            overflow-y: auto;
        }

        .input-area {
            background: #0d1117;
            padding: 10px 20px;
            border-top: 1px solid #30363d;
            display: flex;
        }

        .prompt { color: #58a6ff; margin-right: 10px; }

        #user-input {
            background: transparent;
            border: none;
            color: var(--variable);
            width: 100%;
            outline: none;
            font-family: inherit;
        }

        .key { color: var(--keyword); }
        .fn { color: var(--function); }
        .var { color: var(--variable); }
        .cmt { color: var(--comment); }
    .res { color: var(--accent); font-weight: bold; }

    /* Media Queries untuk Responsivitas Mobile */
    @media (max-width: 768px) {
      body {
        padding: 20px;
      }

      h2 {
        font-size: 1.5rem;
        margin-bottom: 20px;
      }

      .container {
        flex-direction: column;
        gap: 20px;
        height: auto;
      }

      .blocks-panel {
        flex: none;
        height: auto;
        padding: 15px;
      }

      .block-logic {
        padding: 10px;
        font-size: 13px;
      }

      .terminal-panel {
        flex: none;
        height: 300px;
      }

      #terminal {
        padding: 15px;
        font-size: 13px;
      }

      .input-area {
        padding: 8px 15px;
      }

      .prompt {
        margin-right: 8px;
      }

      #user-input {
        font-size: 13px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 15px;
      }

      h2 {
        font-size: 1.3rem;
        margin-bottom: 15px;
      }

      .container {
        gap: 15px;
      }

      .blocks-panel {
        padding: 12px;
      }

      .block-logic {
        padding: 8px;
        font-size: 12px;
      }

      .terminal-panel {
        height: 250px;
      }

      #terminal {
        padding: 12px;
        font-size: 12px;
      }

      .input-area {
        padding: 6px 12px;
      }

      .prompt {
        margin-right: 6px;
      }

      #user-input {
        font-size: 12px;
      }
    }
    </style>
</head>
<body>

    <h2 style="color: #58a6ff;">PhiQu Studio</h2>

    <div class="container">
        <div class="blocks-panel">
            <h3 style="font-size: 12px; color: #8b949e;">COMMAND LIST</h3>
            <button class="block-logic" onclick="runScript('SPEED')">execute wave_speed()</button>
            <button class="block-logic" onclick="runScript('DAWAI')">execute freq_dawai()</button>
            <button class="block-logic" onclick="runScript('PIPA_TERBUKA')">execute pipa_terbuka()</button>
            <button class="block-logic" onclick="runScript('PIPA_TERTUTUP')">execute pipa_tertutup()</button>
            <button class="block-logic" onclick="runScript('DOPPLER')">execute doppler_analyzer()</button>
            <button class="block-logic" onclick="runScript('TI')">execute decibel_calc()</button>
            <button class="block-logic" onclick="runScript('LAYANGAN')">execute beat_frequency()</button>
            <br><br>
            <button onclick="resetTerminal()" style="width:100%; background:#da3633; color:white; border:none; padding:8px; border-radius:4px; cursor:pointer;">Reset</button>
        </div>

        <div class="terminal-panel">
            <div id="terminal"><span class="cmt">// System ready. Click a command to start.</span></div>
            <div class="input-area">
                <span class="prompt">➜</span>
                <input type="text" id="user-input" autocomplete="off" onkeydown="handleInput(event)">
            </div>
        </div>
    </div>

    <script>
        const term = document.getElementById("terminal");
        const userInput = document.getElementById("user-input");
        let currentMode = "";
        let step = 0;
        let data = {};

        async function typeHtml(html) {
            const line = document.createElement("div");
            term.appendChild(line);
            line.innerHTML = html;
            term.scrollTop = term.scrollHeight;
            await new Promise(res => setTimeout(res, 80));
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            msg.lang = 'id-ID';
            window.speechSynthesis.speak(msg);
        }

        function resetTerminal() {
            term.innerHTML = '<span class="cmt">// Terminal reset.</span>';
            currentMode = ""; step = 0; data = {};
        }

        async function runScript(mode) {
            resetTerminal();
            currentMode = mode;
            
            if (mode === 'SPEED') {
                await typeHtml('<span class="key">function</span> <span class="fn">calculate_speed</span>() {');
                await typeHtml('  <span class="key">var</span> <span class="var">s</span> = <span class="cmt">/* input */</span>;');
                await typeHtml('  <span class="key">var</span> <span class="var">t</span> = <span class="cmt">/* input */</span>;');
                await typeHtml('  <span class="key">return</span> <span class="var">s</span> / <span class="var">t</span>;');
                await typeHtml('}');
                speak("Fungsi cepat rambat aktif. Masukkan nilai jarak.");
                await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai s (meter) */</span>');
            }

            else if (mode === 'DAWAI' || mode === 'PIPA_TERBUKA') {
                await typeHtml('<span class="key">function</span> <span class="fn">harmonic_freq</span>(<span class="var">n, v, L</span>) {');
                await typeHtml('  <span class="key">return</span> ((<span class="var">n</span> + <span class="var">1</span>) * <span class="var">v</span>) / (<span class="var">2</span> * <span class="var">L</span>);');
                await typeHtml('}');
                speak("Analisis harmonik dimulai. Masukkan urutan nada. Nol untuk nada dasar.");
                await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai n (0, 1, 2...) */</span>');
            } 
            else if (mode === 'PIPA_TERTUTUP') {
                await typeHtml('<span class="key">function</span> <span class="fn">freq_tertutup</span>(<span class="var">n, v, L</span>) {');
                await typeHtml('  <span class="key">return</span> ((<span class="var">2</span>*<span class="var">n</span> + <span class="var">1</span>) * <span class="var">v</span>) / (<span class="var">4</span> * <span class="var">L</span>);');
                await typeHtml('}');
                speak("Pipa organa tertutup. Masukkan urutan nada.");
                await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai n (0, 1, 2...) */</span>');
            }

            else if (mode === 'DOPPLER') {
                await typeHtml('<span class="key">function</span> <span class="fn">doppler_effect</span>(<span class="var">fs, vp, vs</span>) {');
                await typeHtml('  <span class="key">const</span> <span class="var">v</span> = <span class="var">340</span>; <span class="cmt">// speed of sound</span>');
                await typeHtml('  <span class="key">return</span> ((<span class="var">v</span> ± <span class="var">vp</span>) / (<span class="var">v</span> ∓ <span class="var">vs</span>)) * <span class="var">fs</span>;');
                await typeHtml('}');
                speak("Analisis Doppler dimulai. Masukkan frekuensi sumber bunyi.");
                await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai fs (Hz) */</span>');
            }

            else if (mode === 'TI') {
                await typeHtml('<span class="key">function</span> <span class="fn">calculate_TI</span>(<span class="var">ti1, n</span>) {');
                await typeHtml('  <span class="key">return</span> <span class="var">ti1</span> + <span class="var">10</span> * <span class="fn">Math.log10</span>(<span class="var">n</span>);');
                await typeHtml('}');
                speak("Kalkulator Taraf Intensitas. Masukkan nilai TI untuk satu sumber.");
                await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai TI1 (dB) */</span>');
            }
            else if (mode === 'LAYANGAN') {
                await typeHtml('<span class="key">function</span> <span class="fn">calc_beats</span>(<span class="var">f1, f2</span>) {');
                await typeHtml('  <span class="key">return</span> <span class="fn">Math.abs</span>(<span class="var">f1</span> - <span class="var">f2</span>);');
                await typeHtml('}');
                speak("Analisis pelayangan bunyi. Masukkan frekuensi pertama.");
                await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai f1 (Hz) */</span>');
            }
        }

        function handleInput(e) {
            if (e.key === "Enter") {
                const val = userInput.value.trim();
                if (!val) return;
                const line = document.createElement("div");
                line.innerHTML = `<span class="prompt">➜</span> <span style="color:var(--variable)">${val}</span>`;
                term.appendChild(line);
                userInput.value = "";
                process(val);
            }
        }

        async function process(val) {
            const num = parseFloat(val);
            if (currentMode === 'SPEED') {
                if (step === 0) {
                    data.s = num; step++;
                    speak("Masukkan nilai waktu.");
                    await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai t (sekon) */</span>');
                } else {
                    const result = data.s / num;
                    await typeHtml('<span class="cmt">// Processing: distance / time...</span>');
                    await typeHtml(`<span class="res">> RESULT: v = ${result.toFixed(2)} m/s.</span>`);
                    speak(`Kalkulasi selesai. Cepat rambat bunyi adalah ${result.toFixed(1)} meter per sekon.`);
                    currentMode = ""; step = 0;
                }
            }

            else if (currentMode === 'DAWAI' || currentMode === 'PIPA_TERBUKA' || currentMode === 'PIPA_TERTUTUP') {
                if (step === 0) {
                    data.n = num; step++;
                    speak("Masukkan cepat rambat bunyi.");
                    await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai v (m/s) */</span>');
                } else if (step === 1) {
                    data.v = num; step++;
                    speak("Masukkan panjang medium.");
                    await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai L (meter) */</span>');
                } else {
                    let res;
                    if (currentMode === 'PIPA_TERTUTUP') {
                        res = ((2 * data.n + 1) * data.v) / (4 * num);
                    } else {
                        res = ((data.n + 1) * data.v) / (2 * num);
                    }
                    await typeHtml('<span class="cmt">// Calculating harmonic frequency...</span>');
                    await typeHtml(`<span class="res">> RESULT: f${data.n} = ${res.toFixed(1)} Hz.</span>`);
                    speak(`Frekuensi nada yang dihasilkan adalah ${res.toFixed(0)} Hertz.`);
                    currentMode = ""; step = 0;
                }
            }

            else if (currentMode === 'DOPPLER') {
                if (step === 0) {
                    data.fs = num; step++;
                    speak("Pendengar mendekat atau menjauh? Ketik 1 untuk mendekat, 2 untuk menjauh.");
                    await typeHtml('<span class="cmt">/* PENDENGAR: [1] Mendekat (+) | [2] Menjauh (-) */</span>');
                } else if (step === 1) {
                    data.dirP = num === 1 ? 1 : -1; step++;
                    speak("Masukkan kecepatan pendengar.");
                    await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai vp (m/s) */</span>');
                } else if (step === 2) {
                    data.vp = num; step++;
                    speak("Sumber mendekat atau menjauh? Ketik 1 untuk mendekat, 2 untuk menjauh.");
                    await typeHtml('<span class="cmt">/* SUMBER: [1] Mendekat (-) | [2] Menjauh (+) */</span>');
                } else if (step === 3) {
                    data.dirS = num === 1 ? -1 : 1; step++;
                    speak("Masukkan kecepatan sumber.");
                    await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai vs (m/s) */</span>');
                } else {
                    const v = 340;
                    const fp = ((v + (data.dirP * data.vp)) / (v + (data.dirS * num))) * data.fs;
                    await typeHtml('<span class="cmt">// Calculating Doppler Shift...</span>');
                    await typeHtml(`<span class="res">> RESULT: Observed Frequency (fp) = ${fp.toFixed(1)} Hz.</span>`);
                    speak(`Frekuensi yang terdengar oleh pendengar adalah ${fp.toFixed(0)} Hertz.`);
                    currentMode = ""; step = 0;
                }
            }

            else if (currentMode === 'TI') {
                if (step === 0) {
                    data.ti1 = num; step++;
                    speak("Masukkan jumlah sumber bunyi.");
                    await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan jumlah sumber (n) */</span>');
                } else {
                    const tin = data.ti1 + (10 * Math.log10(num));
                    await typeHtml('<span class="cmt">// Processing Logarithmic Scale...</span>');
                    await typeHtml(`<span class="res">> RESULT: Total Taraf Intensitas = ${tin.toFixed(1)} dB.</span>`);
                    speak(`Taraf intensitas total dari ${num} sumber adalah ${tin.toFixed(1)} desibel.`);
                    currentMode = ""; step = 0;
                }
            }
            else if (currentMode === 'LAYANGAN') {
                if (step === 0) {
                    data.f1 = num; step++;
                    speak("Masukkan frekuensi kedua.");
                    await typeHtml('<span class="cmt">/* INPUT_REQUIRED: Masukkan nilai f2 (Hz) */</span>');
                } else {
                    const fl = Math.abs(data.f1 - num);
                    await typeHtml('<span class="cmt">// Calculating frequency difference...</span>');
                    await typeHtml(`<span class="res">> RESULT: Beat Frequency (fl) = ${fl} Hz.</span>`);
                    speak(`Terjadi ${fl} layangan per detik.`);
                    currentMode = ""; step = 0;
                }
            }
        }
    </script>
</body>
</html>